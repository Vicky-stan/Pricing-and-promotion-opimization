# Pricing and promotion Optimization for Grocery retail store
## Introduction
Paully Pet store is a growing store that delivers their goods all over Nigeria and are being faced with low profit margins and a slow-down in repeat purchases. Leadership suspect that the discount strategies being used by the company is under-cutting profitablibity and are hereby seeking a data-driven approach that will increase sales, pricing, bundling, and promotions.

With SQL, I performed an EDA to gather information about the performance health of the business and a detailed analysis to identify patterns in customer behaviour, margin contribution, and bundle effectiveness that will lead to clear, actionable plans.

## Project Description
This project involves the analysis of the sales and customers data. The tasks to be completed are:
- Explore the data to determine the total revenue generated by each product and the product category.
- Explore the sales trend to determine the total sales, COGS and profit over time.
- Explore the sales trend to determine the peak month
- Perform a part-to-whole analysis to determine which productcategory and productsubcategory contribute to the overall sales
- Explore the data to determine the relationship between the various bundles, promo strategies, and profitability.
- Explore the data to determine the profitable products and cities with the most customers.
- Create a markdown file for deployment.
- Host on the code on Guithub or Gitlab.

## Research Questions
1. Determine the total revenue generated by each product.
2. Determine the total revenue generated by each product category.
3. Calculate the total sales, COGS, AND Profit over time.
4. Which month had the highest sales or the peak month?
5. Which productcategory & subcategories contribute to the overall sales?
6. Calculate the top 5 products with the highest gross margins.
7. How do discount vs volume deal promotions impact promo uplift?
8. Which promotion type results in higher AOV (Average Order Value)?
9. Which products drive the most add-on purchases (attach rate)?
10. How does Customer Lifetime Value (CLV) vary across cities?
11. Which bundles strike the best tradeoff between profit margin and customer perception?

## About the Dataset
The dataset is a simulated dataset that contains 18 colunmns and 15,000 rows. Each data entry represents a sales transaction with unique identifier. Link to the dataset 

The dataset 1800 rows 15 columns with SKU transaction information. The columns are described as follows:
- TransactionID: A unique ID assigned to each transaction.
- CustomerID: A unique ID for each customer.
- ProductID: A unique ID for each product or SKU purchased.
- ProductName: The name of each products.
- SignupDate: Date the customer was signed up on the platform.
- City: City the transaction was carried out.
- State: State that the transaction was carried out.
-- ProductSubCategory: Specific grouping of products within a broader category, helping to further organize and refine the product offerings.
- Quantity: Total SKU units purchased per SKU transaction.
- DiscountPercentage: Agreed discount per SKU purchase.
- CostPrice: Price the SKU was purchased at.
- UnitPrice: Selling price of the SKU.
- PromoApplied: True/ False Validation to indicate if the transaction was a promo sale or baseline sale.
- PromoType: Indicator of the type of promo applied.
- AttachRate: A numeric indicator indicating the rate at which an SKU was purchased with other SKUs.
- TransactionDate: Date the transaction occurred.

## Languages, Utilities, and Environment Used
- Microsoft Excel: Used for data cleaning and preparation.
- SQL: Data transformation, Analysis, and Exploration.
- Environment: Microsoft SQL Management Server (SSMS).

## Data Importation Into SSMS
- Launched the Microsoft SQL Management StudiO
- Navigated to the database > created a database > selected Tasks > selected Import flat file
- In the new window that appears, I clicked on Next
- Used the drop-down menu and selected Flat File Source > Next
- Clicked on Browse > selected the file from my computer > Open
- Validated column properties such as primary key, data type, allow nulls

The above steps successfully imported the dataset into my database in SQL Server.

## Data Analysis Using SQL Generated Queries
1. Determine the total revenue generated by each product
```sql
SELECT 
       ProductID,
       ProductName,
    SUM(Quantity * UnitPrice * (1 - DiscountPercentage / 100.0)) AS TotalRevenue
FROM [Customer transactions]
GROUP BY ProductID, ProductName
ORDER BY TotalRevenue DESC
```
2. Determine the total revenue generated by each product category
```
SELECT 
	ProductCategory,
	ROUND(SUM(Quantity * UnitPrice * (1-DiscountPercentage /100)),2) AS Revenue
FROM [Customer transactions]
GROUP BY ProductCategory
```
3. Calculate the total sales, COGS, and Profit over time
```
SELECT 
	YEAR(TransactionDate)  AS trans_year,
	SUM(CostPrice * Quantity) AS COGS,
	ROUND(SUM(Quantity * UnitPrice * (1- DiscountPercentage/100)),2) AS Sales
FROM [Customer transactions]
GROUP BY Year(TransactionDate)
```
4. Which month had the highest sales or the peak month?
```
SELECT 
	  DATENAME(MONTH, TransactionDate) AS Month,
	  ROUND(SUM(Quantity * Unitprice * (1- DiscountPercentage/100)),2) AS TotalSales
  FROM dbo.[Customer transactions]
  GROUP BY DATENAME(MONTH, TransactionDate) 
  ORDER BY TotalSales DESC 
```
5. Which productcategory & subcategories contribute to the overall sales?
```
WITH SUBCATEGORY_SALES AS (
SELECT 
    ProductCategory,
	ProductSubcategory,
	ROUND(SUM(Quantity * UnitPrice *(1- DiscountPercentage /100)),2) AS total_sales
FROM [Customer transactions]
GROUP BY ProductCategory, ProductSubcategory
)
SELECT TOP 5
    ProductCategory,
	ProductSubcategory,
	total_sales,
	SUM(total_sales) OVER () OverallSales,
	CONCAT(ROUND((CAST(total_sales AS FLOAT)/ SUM(total_sales) OVER ()) * 100, 2), '%') Percent_total
	FROM SUBCATEGORY_SALES
	ORDER BY total_sales DESC
```
6. Calculate the Products that are the top 5 highest gross margins
```
WITH Gross_Margin_Calculation AS (
SELECT 
	ProductID,
	ProductName,
	SUM(UnitPrice * Quantity *  (1 - DiscountPercentage/100)) AS Revenue,
	SUM(CostPrice * Quantity) AS COGS
FROM [Customer transactions]
GROUP BY ProductID, ProductName
)
SELECT TOP 5
	ProductID,
	ProductName,
	ROUND(AVG((Revenue - COGS )/Revenue), 2) AS Gross_margin_percent
FROM Gross_Margin_Calculation
GROUP BY ProductID, ProductName
ORDER BY Gross_margin_percent DESC
```
7. Comparing the performance in Revenue between the different promo types to the baseline sales to determine promo uplift.
```
WITH Baseline_Revenue AS (
SELECT 
	SUM(UnitPrice * Quantity * (1 - DiscountPercentage /100)) AS Baseline_rev
FROM [Customer transactions]
WHERE PromoApplied = 0
), 
  Promo_Revenue AS (
  SELECT
      PromoType,
     SUM(UnitPrice * Quantity * (1 - DiscountPercentage /100)) AS Revenue_promo
FROM [Customer transactions]
WHERE PromoApplied = 1
AND PromoType IN ('Discount', 'Flash Sale', 'Buy One Get One')
GROUP BY PromoType
)
SELECT 
	PromoType,
	round((Revenue_promo - Baseline_rev)/Baseline_rev,2) as PromoUplift
from 
	Baseline_Revenue, Promo_Revenue;
```
8. Attach Rate
- Which Products drive the most add-ons?
```
SELECT 
	ProductID, 
	ProductName,
	AVG(AttachRate)  AS attach_rate
FROM [Customer transactions]
GROUP BY ProductID, ProductName
ORDER BY attach_rate DESC
```
9. Average Order Volume (AOV)
- Determining which promo type drove the highest average order volume. This will help in determining which SKUs is driving revenue in terms of return purchases i.e. frequency.
```

SELECT 
	PromoType, 
	SUM(UnitPrice * Quantity * (1- DiscountPercentage /100)) / COUNT(DISTINCT TransactionID) AS AOV
FROM [Customer transactions]
where 
    PromoApplied = 1 
	AND PromoType in ('Discount','Flash Sale', 'Buy One Get One')
GROUP BY 
	PromoType
```
10. Customer Lifetime Segmentation by City
- Determine the CLV by city. This will help in assessing which city is the top performing in terms of the total worth of customer since acquisition.
```
WITH CLV_calculation AS (
SELECT 
	City,
	CustomerID,
	DATEDIFF(MONTH, MIN(SignupDate), MAX(TransactionDate)) AS customer_lifespan,
	COUNT(DISTINCT TransactionID) AS Purchase_frequency,
	SUM(UnitPrice * Quantity * (1 - DiscountPercentage /100)) / COUNT(DISTINCT TransactionID) AS Avg_revenue
FROM [Customer transactions]
GROUP BY City, CustomerID
),
 CLV_Per_Customer AS (
   SELECT 
    City, 
	(Avg_revenue *  Purchase_frequency * customer_lifespan) AS Customer_CLV,
	COUNT(DISTINCT CustomerID) AS total_customers
FROM CLV_calculation
GROUP BY City, (Avg_revenue *  Purchase_frequency * customer_lifespan)
) 
SELECT 
  City,
  ROUND(SUM( Customer_CLV) / SUM(total_customers), 2) AS CLV_per_city
  FROM CLV_Per_Customer
  GROUP BY City
  ORDER BY CLV_per_city DESC
```
11. Bundle Performance
- Determining which bundles are top performing in terms of margins and perception trade-off.
```
SELECT 
	ProductName,
	ROUND(SUM(UnitPrice * Quantity * (1 - DiscountPercentage/ 100)) - SUM(CostPrice * Quantity) / SUM (UnitPrice * Quantity * (1 - DiscountPercentage/ 100)),4) AS Gross_margin_percent,
	COUNT (DISTINCT TransactionID) AS number_of_orders,
	round(avg(AttachRate),2) as AttachRate
FROM [Customer transactions]
GROUP BY ProductName
ORDER BY Gross_margin_percent DESC,
         number_of_orders DESC,
		 AttachRate DESC
```
## Insights from the Data Analysis 
